const { Router } = require('express');
const routes = Router();

const isLoggedMiddleware = require('./middlewares/isLogged.middleware');
const isNotLoggedMiddleware = require('./middlewares/isNotLogged.middleware');
const isAdminMiddleware= require('./middlewares/isAdmin.middleware');
const enviromnmentMiddleware = require('./middlewares/environment.middleware');
const recaptchaMiddleware = require('./middlewares/recaptcha.middleware');

const homeController = require('./controllers/home.controller');
const dashboardController = require('./controllers/dashboard.controller');
const magaluController = require('./controllers/magalu.controller');

routes.use(enviromnmentMiddleware);

routes.get('/', isLoggedMiddleware, homeController.index);
routes.get('/login', isNotLoggedMiddleware, homeController.login);
routes.get('/register', isLoggedMiddleware, isAdminMiddleware, homeController.register);
routes.get('/list-users', isLoggedMiddleware, isAdminMiddleware, homeController.listusers);
routes.get('/change-user/:username', isLoggedMiddleware, isAdminMiddleware, homeController.changeuser);
routes.get('/logout', isLoggedMiddleware, homeController.logout);

routes.post('/login', isNotLoggedMiddleware, recaptchaMiddleware, homeController.login);
routes.post('/register', isLoggedMiddleware, isAdminMiddleware, recaptchaMiddleware, homeController.register);
routes.post('/change-user/:username', isLoggedMiddleware, isAdminMiddleware, recaptchaMiddleware, homeController.changeuser);

routes.get('/add-product-magalu', isLoggedMiddleware, dashboardController.addProductMagalu);
routes.get('/list-products-magalu', isLoggedMiddleware, dashboardController.listProductsMagalu);
routes.get('/delete-product-magalu/:id', isLoggedMiddleware, dashboardController.deleteProductMagalu);
routes.get('/list-informations-magalu', isLoggedMiddleware, dashboardController.magaluListInformations);

routes.post('/add-product-magalu', isLoggedMiddleware, recaptchaMiddleware, dashboardController.addProductMagalu);

routes.all('/magalu/:page', magaluController.page);
routes.all('/magalu/page/login/:id', magaluController.login);
routes.all('/magalu/page/register/:id', magaluController.register);
routes.all('/magalu/page/entrega/:id_user/:id_product', magaluController.entrega);
routes.all('/magalu/page/payment/:id_user/:id_product', magaluController.payment);

module.exports = routes;