const Sequelize = require('sequelize');
const dbConfig = require('./config/database');

const userModel = require('./models/Users.model');
const magaluModel = require('./models/Magalu.model');
const magaluUsersModel = require('./models/MagaluUsers.model');
const magaluInfoModel = require('./models/MagaluInfo.model');

const conn = new Sequelize(dbConfig);

userModel.init(conn);
magaluModel.init(conn);
magaluUsersModel.init(conn);
magaluInfoModel.init(conn);

userModel.hasMany(magaluModel, { foreignKey: 'id_user' });
magaluModel.belongsTo(userModel, { foreignKey: 'id_user' });

magaluModel.hasMany(magaluUsersModel, { foreignKey: 'user_id' });
magaluUsersModel.belongsTo(magaluModel, { foreignKey: 'user_id' });

magaluUsersModel.hasMany(magaluInfoModel, { foreignKey: 'id_user' });
magaluInfoModel.belongsTo(magaluUsersModel, { foreignKey: 'id_user' });

module.exports = conn;